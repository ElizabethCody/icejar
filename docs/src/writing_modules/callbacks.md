# Step 2: Adding a Callback

Callbacks are objects which provide methods to be called in response to events
which occur on the Mumble server. In this step, we will add a callback which
responds to text messages being sent on the Mumble server.

add the following class to `Module.java` (note that this class is _not_ public):

```java
class Callback implements icejar.DefaultServerCallback {

    @Override
    public void userTextMessageThrowsException(
            User state, TextMessage message, Current current)
            throws Exception
    {
        System.out.println(message.text);
    }
}
```

This callback will print the contents of each text message which gets sent to
the Mumble server.

The interface which must be implemented by server callbacks is generated by Ice
and can be unwieldly to use, since it requires a handler method for each type
of event and does not allow said handler methods to throw exceptions. For this
reason, Icejar provides a sub-interface called
[`DefaultServerCallback`](../../module-api/icejar/DefaultServerCallback.html)
which provides a default handler for each event type that does nothing and
allows handler methods to throw exceptions. This allows you to only implement
the methods you need, as demonstrated above.

Just defining the callback isn't enough: it needs to be added to the server. To
do this, add the following import statement to the top of `Module.java`:

```java
import static icejar.IceHelper.*;
```

The [`IceHelper`](../../module-api/icejar/IceHelper.html) utility class provides
the `addServerCallback` method. To use it, add the following to the body of the
`setup` method on the `Module` class:

```java
addServerCallback(server, adapter, new Callback());
```

There is now enough functionality that this module will do something if it is
added to a Mumble server. You can package it up into a JAR file using the
following commands:

First, compile the module with:

```shell
$ javac -classpath MumbleIceModuleAPI.jar Module.java
```

Then, create the JAR file containing the module with:

```shell
$ jar cf demo_module.jar *.class
```

Following the instructions in the [usage](usage.md) chapter, you can see the
module in action!

